/*https://github.com/pyrsmk/Sheethub*/this.Sheethub=function(){var a=document,b="getElementsByTagName",c="removeChild",d="parentNode",e={},f=!1,g=[],h=0,i,j=[],k=a[b]("link"),l=a[b]("style"),m,n,o=function(){if(!--h){f=!0;var a=g.length;while(a)g[--a]()}},p=function(e){var f,g=!1,h=[],i,j="disabled",k="appendChild",l="createTextNode",m=window,n="ActiveXObject",o="Msxml2.XMLHTTP.",p="responseText",q,r="status",s=[function(){return new m[n](o+"3.0")},function(){return new m[n](o+"6.0")},function(){return new m.XMLHttpRequest}],t=function(){a[b]("head")[0][k](f=a.createElement("style"))},u=function(){g=!0,i=h.length;while(i)h[--i]()},v={listen:function(a){h.push(a)},ready:function(){return g},contents:function(a){if(!a)return f.innerHTML||f.text;f.tagName=="LINK"&&(f[d][c](f),t());try{f.innerHTML=a}catch(b){f.text=a}},get:function(){return f}};if(typeof e=="object"){f=e;if(f.tagName=="LINK"){i=s.length;while(i)try{q=s[--i]()}catch(w){}q.open("GET",f.href,!0),q.onreadystatechange=function(){if(q.readyState==4)if(!q[r]||q[r]==200||q[r]==304)v.contents(q[p].replace(/\.\.\//g,"")),u();else throw q.statusText},q.send(null)}}else t(),typeof e=="string"&&v.contents(e),u();return v},q={listen:function(a){g.push(a)},ready:function(){return f},has:function(a){return e[a]},add:function(a,b){q.has(a)||(e[a]=new p(b))},get:function(a){if(q.has(a))return e[a]},remove:function(a){q.has(a)&&(m=e[a].get(),m[d][c](m),delete e[a])},getAll:function(){return e}};m=-1;while(n=k[++m])n.rel!="icon"&&(j.push(n),++h);m=l.length;while(m)j.push(l[--m]);m=-1;while(i=j[++m]){if((n=i.title)===""||q.has(n))while(q.has(n=Math.round(Math.random()*89+10)));q.add(n,i),e[n].ready()?o():e[n].listen(o)}return q}();
