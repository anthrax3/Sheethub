var Sheethub={},Stylesheet;(function(a,b){function c(){var a=[];this.addListener=function(b,c){a[b=b.toLowerCase()]===undefined&&(a[b]=[]),a[b].push(c);return this},this.removeListener=function(b,c){var d=a[b=b.toLowerCase()];for(var e in d)if(d[e]===c){d.splice(e,1);break}a[b]=d;return this},this.getListeners=function(b){return a[b=b.toLowerCase()]!==undefined?a[b]:a},this.clearListeners=function(){a=[];return this},this.dispatch=function(b){var c=a[b=b.toLowerCase()];for(var d in c)c[d]();return this}}Stylesheet=function(d){var e=!1,f,g=new c;this.addListener=function(a,b){return g.addListener(a,b)},this.removeListener=function(a,b){return g.removeListener(a,b)},this.getListeners=function(a){return g.getListeners(a)},this.clearListeners=function(){return g.clearListeners()};var h=function(a){return g.dispatch(a)},i=function(){f=b.createElement("style"),f.type="text/css",f.rel="stylesheet",b.getElementsByTagName("head")[0].appendChild(f)},j=function(){return f.sheet!==undefined?f.sheet:f.styleSheet},k=function(){var b=[function(){return new a.ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new a.ActiveXObject("Msxml2.XMLHTTP.6.0")},function(){return new a.XMLHttpRequest}],c=b.length;while(c--)try{return b[c]()}catch(d){}return!1},l=function(){var a=k();if(a===undefined)throw"XmlHttpRequest is not available";a.open("GET",f.href,!0),a.onreadystatechange=function(){if(a.readyState==4){if(a.status!=200&&a.status!=304)throw"Ouch! Bad returned state: "+a.statusText;try{f.appendChild(b.createTextNode(a.responseText))}catch(c){f.text=a.responseText}e=!0,h("ready")}},a.send(null)};this.isReady=function(){return e},this.isDetached=function(){return f===null},this.detach=function(){f.parentNode.removeChild(f),f=null;return this},this.setContents=function(a){f.tagName=="LINK"&&(this.detach(),this.createNewNode());try{var c=f.firstChild;c&&f.removeChild(c),f.appendChild(b.createTextNode(a))}catch(d){f.text=a}return this},this.getContents=function(){if(f.textContent!==undefined)return f.textContent;return f.text},this.setMedias=function(a){f.media=a.join(",");return this},this.getMedias=function(){var a=f.media.split(",");a[0]===""&&a.splice(0,1);return a},this.addMedia=function(a){var b=this.getMedias();b.push(a),this.setMedias(b);return this},this.removeMedia=function(a){var b=this.getMedias();for(var c in b)if(b[c]==a){b.splice(c,1);break}this.setMedias(b);return this},this.isDisabled=function(){return j().disabled},this.enable=function(){j().disabled=!1;return this},this.disable=function(){j().disabled=!0;return this},d===undefined?(i(),e=!0,h("ready")):typeof d=="string"?(i(),this.setContents(d),e=!0,h("ready")):(f=d,f.tagName=="LINK"&&l())};var d=!1,e=[],f=0,g=new c;Sheethub.addListener=function(a,b){return g.addListener(a,b)},Sheethub.removeListener=function(a,b){return g.removeListener(a,b)},Sheethub.getListeners=function(a){return g.getListeners(a)},Sheethub.clearListeners=function(){return g.clearListeners()};var h=function(a){return g.dispatch(a)};Sheethub.isReady=function(){return d},Sheethub.hasStylesheet=function(a){return e[a]!==undefined},Sheethub.addStylesheet=function(a,b){if(Sheethub.hasStylesheet(a))throw"The '"+a+"' stylesheet already exists";if(!(b instanceof Stylesheet))throw"The stylesheet object must be of type Stylesheet";e[a]=b;return this},Sheethub.getStylesheet=function(a){if(!Sheethub.hasStylesheet(a))throw"The '"+a+"' stylesheet doesn't exist";return e[a]},Sheethub.removeStylesheet=function(a){if(!Sheethub.hasStylesheet(a))throw"The '"+a+"' stylesheet doesn't exist";e[a].detach(),delete e[a];return this},Sheethub.getStylesheets=function(){return e};var i=[],j=b.getElementsByTagName("link"),k=b.getElementsByTagName("style"),l=j.length;for(var m=0;m<l;++m)i.push(j[m]),++f;l=k.length;for(m=0;m<l;++m)i.push(k[m]);var n=function(){--f===0&&(d=!0,h("ready"))};for(m in i){var o=i[m],p;if((p=o.title)===""||Sheethub.hasStylesheet(p))while(Sheethub.hasStylesheet(p="stylesheet"+Math.round(Math.random()*8999+1e3)));e[p]=new Stylesheet(o),e[p].isReady()?n():e[p].addListener("ready",n)}})(this,this.document)