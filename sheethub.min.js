(function(a,b){function c(){this.listeners=[],this.addListener=function(a,b){this.listeners[a=a.toLowerCase()]===undefined&&(this.listeners[a]=[]),this.listeners[a].push(b)},this.removeListener=function(a,b){var c=this.listeners[a=a.toLowerCase()];for(var d in c)if(c[d]===b){c.splice(d,1);break}this.listeners[a]=c},this.dispatch=function(a){var b=this.listeners[a.toLowerCase()];for(var c in b)b[c]()}}a.Stylesheet=function(d){this.events=new c,this.node,this.isDetached=function(){return this.node===null},this.detach=function(){this.node.parentNode.removeChild(this.node),this.node=null;return this},this.setContents=function(a){this.node.tagName=="LINK"&&(this.detach(),this.createNewNode());try{var c=this.node.firstChild;c&&this.node.removeChild(c),this.node.appendChild(b.createTextNode(a))}catch(d){this.node.text=a}return this},this.getContents=function(){if(this.node.textContent!==undefined)return this.node.textContent;return this.node.text},this.setMedias=function(a){this.node.media=a.join(",");return this},this.getMedias=function(){var a=this.node.media.split(",");a[0]===""&&a.splice(0,1);return a},this.addMedia=function(a){var b=this.getMedias();b.push(a),this.setMedias(b);return this},this.removeMedia=function(a){var b=this.getMedias();for(var c in b)if(b[c]==a){b.splice(c,1);break}this.setMedias(b);return this},this.getRules=function(){var a=this.getCSSStyleSheet();return a.cssRules?a.cssRules:a.rules},this.isDisabled=function(){return this.getCSSStyleSheet().disabled},this.enable=function(){this.getCSSStyleSheet().disabled=!1;return this},this.disable=function(){this.getCSSStyleSheet().disabled=!0;return this},this.createNewNode=function(){this.node=b.createElement("style"),this.node.type="text/css",this.node.rel="stylesheet",b.getElementsByTagName("head")[0].appendChild(this.node)},this.getCSSStyleSheet=function(){return this.node.sheet!==undefined?this.node.sheet:this.node.styleSheet},this.getXHRObject=function(){var b=[function(){return new a.ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new a.ActiveXObject("Msxml2.XMLHTTP.6.0")},function(){return new a.XMLHttpRequest}],c=b.length;while(c--)try{return b[c]()}catch(d){}return!1},this.retrieveStylesheet=function(){var a=this.node,c=this.events,d=this.getXHRObject();if(d===undefined)throw"XmlHttpRequest is not available";d.open("GET",a.href,!0),d.onreadystatechange=function(){if(d.readyState==4){if(d.status!=200&&d.status!=304)throw"Ouch! Bad returned state: "+d.statusText;try{a.appendChild(b.createTextNode(d.responseText))}catch(e){a.text=d.responseText}c.dispatch("ready")}},d.send()},d===undefined?this.createNewNode():typeof d=="string"?(this.createNewNode(),this.setContents(d)):(this.node=d,this.node.tagName=="LINK"&&this.retrieveStylesheet())};if(a.Sheethub===undefined){a.Sheethub={},a.Sheethub.ready=!1,a.Sheethub.events=new c;var d=[],e=0;a.Sheethub.hasStylesheet=function(a){return d[a]!==undefined},a.Sheethub.addStylesheet=function(b,c){if(a.Sheethub.hasStylesheet(b))throw"The '"+b+"' stylesheet already exists";if(!(c instanceof a.Stylesheet))throw"The stylesheet object must be of type Stylesheet";d[b]=c;return this},a.Sheethub.getStylesheet=function(b){if(!a.Sheethub.hasStylesheet(b))throw"The '"+b+"' stylesheet doesn't exist";return d[b]},a.Sheethub.removeStylesheet=function(b){if(!a.Sheethub.hasStylesheet(b))throw"The '"+b+"' stylesheet doesn't exist";d[b].detach(),delete d[b];return this},a.Sheethub.getStylesheets=function(){return d};var f=[],g=b.getElementsByTagName("link"),h=g.length;for(var i=0;i<h;++i)f.push(g[i]),++e;var j=b.getElementsByTagName("style");h=j.length;for(i=0;i<h;++i)f.push(j[i]);var k=function(){--e===0&&(a.Sheethub.ready=!0,a.Sheethub.events.dispatch("ready"))};for(i in f){var l=f[i],m;if((m=l.title)===""||a.Sheethub.hasStylesheet(m))while(a.Sheethub.hasStylesheet(m="stylesheet"+Math.round(Math.random()*8999+1e3)));d[m]=new a.Stylesheet(l),d[m].events.addListener("ready",k)}}})(this,this.document)