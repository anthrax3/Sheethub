/*https://github.com/pyrsmk/Sheethub*/this.Sheethub=function(){var a=document,b="getElementsByTagName",c="removeChild",d="parentNode",e=[],f=!1,g=[],h=0,i,j=[],k=a[b]("link"),l=a[b]("style"),m,n,o=function(){if(!--h){f=!0;var a=g.length;while(a)g[--a]()}},p=function(e){var f,g=!1,h=[],i,j="disabled",k="appendChild",l="createTextNode",m=window,n="ActiveXObject",o="Msxml2.XMLHTTP.",q="responseText",r,s=[function(){return new m[n](o+"3.0")},function(){return new m[n](o+"6.0")},function(){return new m.XMLHttpRequest}],t=function(){f=a.createElement("style"),f.rel="stylesheet",a[b]("head")[0][k](f)},u=function(){return f.sheet!==undefined?f.sheet:f.styleSheet},v=function(){g=!0,i=h.length;while(i)h[--i]()};p.listen=function(a){h.push(a)},p.isReady=function(){return g},p.setContents=function(b){f.tagName=="LINK"&&(f[d][c](f),t());try{(i=f.firstChild)&&f[c](i),f[k](a[l](b))}catch(e){f.text=b}},p.getContents=function(){return f.textContent!==undefined?f.textContent:f.text},p.getNode=function(){return f};if(typeof f=="object"){f=e;if(f.tagName=="LINK"){i=s.length;while(i)try{r=s[--i]()}catch(w){}r.open("GET",f.href,!0),r.onreadystatechange=function(){if(r.readyState==4){if(r.status!=200&&r.status!=304)throw r.statusText;try{f[k](a[l](r[q]))}catch(b){f.text=r[q]}v()}},r.send(null)}}else t(),typeof e=="string"&&p.setContents(e),v()},q={listen:function(a){g.push(a)},isReady:function(){return f},has:function(a){return e[a]},add:function(a,b){q.has(a)||(e[a]=new p(b))},get:function(a){if(q.has(a))return e[a]},remove:function(a){q.has(a)&&(m=e[a].getNode(),m[d][c](m),delete e[a])},getAll:function(){return e}};m=k.length;while(m)j.push(k[--m]),++h;m=l.length;while(m)j.push(l[--m]);m=-1;while(i=j[++m]){if((n=i.title)===""||q.has(n))while(q.has(n=Math.round(Math.random()*89+10)));q.add(n,i),e[n].isReady()?o():e[n].listen(o)}};
